import{R as d,b as _,c as u,t as f,d as S}from"./i18next-CEY2YAwM.js";import{r as T}from"./index-BP8_t0zE.js";function C(a){a===void 0&&(a=d);var e=a===d?_:function(){return T.useContext(a)};return function(){var o=e(),t=o.store;return t}}var A=C();function N(a){a===void 0&&(a=d);var e=a===d?A:C(a);return function(){var o=e();return o.dispatch}}var l=N();const i=u("profile/fetchProfileData",async(a,e)=>{const{extra:R,rejectWithValue:o}=e;try{return(await R.api.get("/profile")).data}catch{return o(f("Ошибка"))}});var s=(a=>(a.INCORRECT_USER_FIRSTNAME="INCORRECT_USER_FIRSTNAME",a.INCORRECT_USER_LASTNAME="INCORRECT_USER_LASTNAME",a.INCORRECT_USER_USERNAME="INCORRECT_USER_USERNAME",a.INCORRECT_USER_AGE="INCORRECT_USER_AGE",a.INCORRECT_USER_COUNTRY="INCORRECT_USER_COUNTRY",a.INCORRECT_CHARACTERS="INCORRECT_CHARACTERS",a.INCORRECT_USER_AVATAR="INCORRECT_USER_AVATAR",a.NO_DATA="NO_DATA",a.SERVER_ERROR="SERVER_ERROR",a))(s||{});const O=a=>{var e;return(e=a.profile)==null?void 0:e.form},I=a=>{if(!a)return[s.NO_DATA];const{firstname:e,lastname:R,age:o,country:t,username:n}=a,r=[];return e||r.push(s.INCORRECT_USER_FIRSTNAME),R||r.push(s.INCORRECT_USER_LASTNAME),(e!=null&&e.match(/\d{1}/)||R!=null&&R.match(/\d{1}/))&&r.push(s.INCORRECT_CHARACTERS),n||r.push(s.INCORRECT_USER_USERNAME),(!o||!Number.isInteger(o))&&r.push(s.INCORRECT_USER_AGE),t||r.push(s.INCORRECT_USER_COUNTRY),r},E=u("profile/updateProfileData",async(a,e)=>{const{extra:R,rejectWithValue:o,getState:t}=e,n=O(t()),r=I(n);if(r!=null&&r.length)return o(r);try{return(await R.api.put("/profile",n)).data}catch{return o([s.SERVER_ERROR])}}),U={readonly:!0,isLoading:!1,error:void 0,data:void 0,form:void 0},c=S({name:"profile",initialState:U,reducers:{setReadonly:(a,e)=>{a.readonly=e.payload},updateProfile:(a,e)=>{a.form={...a.form,...e.payload}},cancelEdit:a=>{a.readonly=!0,a.form=a.data,a.validateError=void 0}},extraReducers:a=>{a.addCase(i.pending,e=>{e.error=void 0,e.isLoading=!0}).addCase(i.fulfilled,(e,R)=>{e.isLoading=!1,e.data=R.payload,e.form=R.payload}).addCase(i.rejected,(e,R)=>{e.isLoading=!1,e.error=R.payload}).addCase(E.pending,e=>{e.validateError=void 0,e.isLoading=!0}).addCase(E.fulfilled,(e,R)=>{e.isLoading=!1,e.data=R.payload,e.form=R.payload,e.readonly=!0,e.validateError=void 0}).addCase(E.rejected,(e,R)=>{e.isLoading=!1,e.validateError=R.payload})}}),{actions:y}=c,{reducer:g}=c,m=()=>l();export{s as V,A as a,m as b,E as c,g as d,i as f,O as g,y as p,l as u};
