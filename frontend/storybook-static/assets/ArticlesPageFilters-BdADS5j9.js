import{j as n}from"./jsx-runtime-CexXSJP5.js";import{r as l}from"./index-BP8_t0zE.js";import{c as M}from"./classNames-DgDD4s-s.js";import"./ArticleDetails-CNEtLzCU.js";import"./ArticleList-CWghEeDZ.js";import{A as N}from"./ArticleViewSelector-C0AkOxhh.js";import{A as V,a as R}from"./ArticleTypeTabs-7M82C3X4.js";import{b as k,f as O,c as D,e as W,d as A}from"./scrollSave-pN11k7oX.js";import{b as f,c as w,A as C}from"./article-CmWc1HkS.js";import{t as F,A as L}from"./localStorage-CnWtazwr.js";import{C as $}from"./Card-CIehstmu.js";import{I as q}from"./Input-SBXS8SFk.js";const ge=a=>{var e;return((e=a.articlesPage)==null?void 0:e.isLoading)||!1},pe=a=>{var e;return(e=a.articlesPage)==null?void 0:e.error},Q=a=>{var e;return((e=a.articlesPage)==null?void 0:e.view)||f.SMALL},G=a=>{var e;return((e=a.articlesPage)==null?void 0:e.page)||1},H=a=>{var e;return((e=a.articlesPage)==null?void 0:e.limit)||9},me=a=>{var e;return(e=a.articlesPage)==null?void 0:e.hasMore},Ae=a=>{var e;return(e=a.articlesPage)==null?void 0:e._inited},_=a=>{var e;return((e=a.articlesPage)==null?void 0:e.search)??""},b=a=>{var e;return((e=a.articlesPage)==null?void 0:e.sort)??w.CREATED},v=a=>{var e;return((e=a.articlesPage)==null?void 0:e.order)??"asc"},T=a=>{var e;return((e=a.articlesPage)==null?void 0:e.type)??C.ALL},K=a=>{const e=new URLSearchParams(window.location.search);return Object.entries(a).map(([t,r])=>{console.log(`${t}: ${r}, name and value`),r!==void 0&&e.set(t,r)}),`?${e.toString()}`},U=a=>{window.history.pushState(null,"",K(a))},P=k("articlesPage/fetchArticles",async(a,e)=>{const{extra:t,rejectWithValue:r,getState:i}=e,y=G(i()),S=H(i()),h=_(i()),s=v(i()),g=b(i()),p=T(i());try{U({sort:g,order:s,search:h,type:p});const m=await t.api.get("/articles",{params:{_limit:S,_page:y,_sort:g,_order:s,type:p===C.ALL?void 0:p,q:h}});if(!m.data)throw new Error;return m.data}catch{return r(F("Ошибка"))}}),d=O({selectId:a=>a.id}),ue=d.getSelectors(a=>a.articlesPage||d.getInitialState()),j=D({name:"articlesPage",initialState:d.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},view:f.SMALL,_inited:!1,hasMore:!0,page:1,limit:9,order:"asc",search:"",sort:w.CREATED,type:C.ALL}),reducers:{setViewMode:(a,e)=>{a.view=e.payload,localStorage.setItem(L,e.payload)},initState:a=>{const e=localStorage.getItem(L);a.view=e,a.limit=e===f.SMALL?9:4,a._inited=!0},setPage:(a,e)=>{a.page=e.payload},setOrder:(a,e)=>{a.order=e.payload},setSearch:(a,e)=>{a.search=e.payload},setSort:(a,e)=>{a.sort=e.payload},setType:(a,e)=>{a.type=e.payload}},extraReducers(a){a.addCase(P.pending,(e,t)=>{e.error=void 0,e.isLoading=!0,t.meta.arg.replace&&d.removeAll(e)}).addCase(P.fulfilled,(e,t)=>{e.isLoading=!1,e.hasMore=t.payload.length>=e.limit,t.meta.arg.replace?d.setAll(e,t.payload):d.addMany(e,t.payload)}).addCase(P.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload})}}),{reducer:he}=j,{actions:o}=j,Y="_search_1aeao_1",z="_sortWrapper_1aeao_5",B="_tabs_1aeao_12",u={search:Y,sortWrapper:z,tabs:B};function J(a,e){const t=l.useRef();return l.useCallback((...r)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{a(...r)},e)},[a,e])}const X=a=>{const{className:e}=a,t=W(),r=A(Q),i=A(_),y=A(b),S=A(v),h=A(T),s=l.useCallback(()=>{t(P({replace:!0}))},[t]),g=J(s,300),p=l.useCallback(c=>{t(o.setViewMode(c))},[t]),m=l.useCallback(c=>{t(o.setSearch(c)),t(o.setPage(1)),g()},[t,g]),x=l.useCallback(c=>{t(o.setOrder(c)),t(o.setPage(1)),s()},[t,s]),E=l.useCallback(c=>{t(o.setSort(c)),t(o.setPage(1)),s()},[t,s]),I=l.useCallback(c=>{t(o.setType(c)),t(o.setPage(1)),s()},[t,s]);return n.jsxs("div",{className:M(u.ArticlesPageFilters,{},[e]),children:[n.jsxs("div",{className:u.sortWrapper,children:[n.jsx(V,{sort:y,order:S,onChangeOrder:x,onChangeSort:E}),n.jsx(N,{className:u.viewSelector,view:r,onViewClick:p})]}),n.jsx($,{className:u.search,children:n.jsx(q,{placeholder:"Поиск",value:i,onChange:m})}),n.jsx(R,{className:u.tabs,onChangeType:I,value:h})]})};X.__docgenInfo={description:"",methods:[],displayName:"ArticlesPageFilters",props:{className:{required:!1,tsType:{name:"string"},description:""}}};export{X as A,G as a,ge as b,o as c,Ae as d,Q as e,P as f,me as g,pe as h,ue as i,he as j};
