import{a as s,t as c,c as T}from"./i18next-Byb45X2d.js";const n=s("profile/fetchProfileData",async(a,R)=>{const{extra:e,rejectWithValue:E}=R;try{const d=await e.api.get(`/profile/${a}`);if(!d.data)throw new Error;return d.data}catch{return E(c("Ошибка"))}});var o=(a=>(a.INCORRECT_USER_FIRSTNAME="INCORRECT_USER_FIRSTNAME",a.INCORRECT_USER_LASTNAME="INCORRECT_USER_LASTNAME",a.INCORRECT_USER_USERNAME="INCORRECT_USER_USERNAME",a.INCORRECT_USER_AGE="INCORRECT_USER_AGE",a.INCORRECT_USER_COUNTRY="INCORRECT_USER_COUNTRY",a.INCORRECT_CHARACTERS="INCORRECT_CHARACTERS",a.INCORRECT_USER_AVATAR="INCORRECT_USER_AVATAR",a.NO_DATA="NO_DATA",a.SERVER_ERROR="SERVER_ERROR",a))(o||{});const u=a=>{var R;return(R=a.profile)==null?void 0:R.form},N=a=>{if(!a)return[o.NO_DATA];const{firstname:R,lastname:e,age:E,country:d,username:C}=a,r=[];return R||r.push(o.INCORRECT_USER_FIRSTNAME),e||r.push(o.INCORRECT_USER_LASTNAME),(R!=null&&R.match(/\d{1}/)||e!=null&&e.match(/\d{1}/))&&r.push(o.INCORRECT_CHARACTERS),C||r.push(o.INCORRECT_USER_USERNAME),(!E||!Number.isInteger(E))&&r.push(o.INCORRECT_USER_AGE),d||r.push(o.INCORRECT_USER_COUNTRY),r},t=s("profile/updateProfileData",async(a,R)=>{const{extra:e,rejectWithValue:E,getState:d}=R,C=u(d()),r=N(C);if(r!=null&&r.length)return E(r);try{const i=await e.api.put(`/profile/${C==null?void 0:C.id}`,C);if(!i.data)throw new Error;return i.data}catch{return E([o.SERVER_ERROR])}}),S={readonly:!0,isLoading:!1,error:void 0,data:void 0,form:void 0},_=T({name:"profile",initialState:S,reducers:{setReadonly:(a,R)=>{a.readonly=R.payload},updateProfile:(a,R)=>{a.form={...a.form,...R.payload}},cancelEdit:a=>{a.readonly=!0,a.form=a.data,a.validateError=void 0}},extraReducers:a=>{a.addCase(n.pending,R=>{R.error=void 0,R.isLoading=!0}).addCase(n.fulfilled,(R,e)=>{R.isLoading=!1,R.data=e.payload,R.form=e.payload}).addCase(n.rejected,(R,e)=>{R.isLoading=!1,R.error=e.payload}).addCase(t.pending,R=>{R.validateError=void 0,R.isLoading=!0}).addCase(t.fulfilled,(R,e)=>{R.isLoading=!1,R.data=e.payload,R.form=e.payload,R.readonly=!0,R.validateError=void 0}).addCase(t.rejected,(R,e)=>{R.isLoading=!1,R.validateError=e.payload})}}),{actions:p}=_,{reducer:A}=_;export{o as V,A as a,n as f,u as g,p,t as u};
